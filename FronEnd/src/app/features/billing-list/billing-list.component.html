<div class="container facturacion-container">
  <div class="row mb-4">
    <!-- Filtro por tienda -->
    <div class="col-md-3 d-flex align-items-center">
      <label for="store" class="mr-2">Tienda:</label>
      <select id="store" class="form-control form-control-sm" (change)="onStoreSelected($event)">
        <option [value]="null" disabled selected>Seleccione una tienda</option>
        <option *ngFor="let store of stores" [value]="store._id"> {{ store.name }} </option>
      </select>
    </div>

    <!-- Filtro por año -->
    <div class="col-md-3 d-flex align-items-center">
      <label for="years" class="mr-2">Año:</label>
      <div class="custom-select year-select" (click)="toggleYearDropdown()">
        <div class="selected-value">{{ selectedYear || 'Seleccione un año' }}</div>
        <div class="options" *ngIf="yearDropdownOpen">
          <div class="option" *ngFor="let year of years" (click)="selectYear(year)">{{ year }}</div>
        </div>
      </div>
    </div>

    <!-- Filtro por mes -->
    <div class="col-md-3 d-flex align-items-center">
      <label for="months" class="mr-2">Mes:</label>
      <div class="custom-select month-select" (click)="toggleMonthDropdown()">
        <div class="selected-value">{{ getSelectedMonthName() }}</div>
        <div class="options" *ngIf="monthDropdownOpen">
          <div class="option" *ngFor="let month of months" (click)="selectMonth(month.value)">{{ month.name }}</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tabla de lista de pagos -->
  <div class="row">
    <div class="col-md-12">
      <!-- Tabla responsive -->
      <div class="table-responsive">
        <table class="table table-bordered table-hover">
          <thead class="thead-light">
            <tr>
              <th class="text-center">Tienda</th>
              <th class="text-center">Mes</th>
              <th class="text-center">Estado</th>
              <th class="text-center">Año</th>
              <th class="text-center">Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngIf="getPaginatedPayments().length === 0">
              <td class="text-center" colspan="5">No hay registros</td>
            </tr>
            <tr *ngFor="let payment of getPaginatedPayments()">
              <td class="text-center">{{ payment.nameShop }}</td>
              <td class="text-center">{{ payment.month }}</td>
              <td class="text-center">{{ payment.statusPayment ? 'Pagado' : 'Pendiente' }}</td>
              <td class="text-center">{{ payment.year }}</td>
              <td class="text-center">
                <button class="btn btn-primary btn-sm" (click)="viewDetails(payment)">
                  <i class="fas fa-search"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Controles de paginación -->
      <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
          <li class="page-item" [class.disabled]="page === 1">
            <a class="page-link" (click)="setPage(page - 1)">Anterior</a>
          </li>
          <li class="page-item" *ngFor="let i of [].constructor(totalPages); let index = index"
            [class.active]="page === (index + 1)">
            <a class="page-link" (click)="setPage(index + 1)">{{ index + 1 }}</a>
          </li>
          <li class="page-item" [class.disabled]="page === totalPages">
            <a class="page-link" (click)="setPage(page + 1)">Siguiente</a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
  <div *ngIf="selectedPaymentImage" class="modal" tabindex="-1" style="display: block;">
    <div class="modal-overlay"></div> <!-- Agregar overlay -->
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Comprobante de pago</h4>
        </div>
        <div class="modal-body text-center">
          <div class="image-gallery">
            <img [src]="selectedPaymentImage" alt="Imagen del registro" class="img-fluid gallery-image">
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn" (click)="closeModal()">Cerrar</button>
        </div>
      </div>
    </div>
  </div>
</div>